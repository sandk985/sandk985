<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandeep Kumar - AI Chatbot Widget</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .widget-container {
            width: 100%;
            max-width: 600px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 80vh;
            max-height: 800px;
        }

        .chatbot-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom: none;
        }

        .chatbot-header h2 {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }

        .chatbot-header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-bubble {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 18px 4px 18px 18px;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .message.bot .message-bubble {
            background: #f0f4f8;
            color: #2d3748;
            border-radius: 4px 18px 18px 18px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            background: #f0f4f8;
            border-radius: 18px;
            width: fit-content;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #cbd5e0;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                opacity: 0.5;
            }
            30% {
                opacity: 1;
            }
        }

        .search-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e2e8f0;
        }

        .search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 50px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.2);
            background: white;
        }

        .search-input::placeholder {
            color: #a0aec0;
        }

        .send-button {
            position: absolute;
            right: 8px;
            background: none;
            border: none;
            color: #667eea;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 8px 12px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .send-button:hover {
            color: #764ba2;
            transform: scale(1.1);
        }

        .send-button:active {
            transform: scale(0.95);
        }

        /* Scrollbar Styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        /* Loading State */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            color: #718096;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 12px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 1.1rem;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .empty-state-subtext {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .widget-container {
                height: 90vh;
                border-radius: 20px;
            }

            .message-bubble {
                max-width: 85%;
            }

            .search-input {
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }
    </style>
</head>
<body>
    <div class="widget-container">
        <!-- Header -->
        <div class="chatbot-header">
            <h2>Ask About Sandeep</h2>
            <p>AI-Powered Resume Assistant</p>
        </div>

        <!-- Chat Area -->
        <div class="chat-messages" id="chatMessages">
            <div class="empty-state">
                <div class="empty-state-icon">ðŸ’¬</div>
                <div class="empty-state-text">Start a conversation</div>
                <div class="empty-state-subtext">Ask anything about Sandeep Kumar's experience</div>
            </div>
        </div>

        <!-- Search/Input Area -->
        <div class="search-container">
            <div class="search-input-wrapper">
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput" 
                    placeholder="Ask anything about Sandeep Kumar"
                    autocomplete="off"
                >
                <button class="send-button" id="sendButton">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L17.1272231,14.0454487 C17.7550917,13.5741566 18.0689606,12.6315722 17.7550917,11.6889879 L4.13399899,2.89 C3.50612381,2.6329026 2.40999899,2.74 1.77946707,3.2 C0.994623095,3.9429026 0.837654301,5.0329026 1.15159189,5.8183895 L3.03521743,12.2593825 C3.03521743,12.4744748 3.34915502,12.4744748 3.50612381,12.4744748 L16.6915026,13.2599618 C16.6915026,13.2599618 17.1272231,13.2599618 17.1272231,12.8429026 L17.1272231,11.6889879 C17.1272231,11.1 17.1272231,12.4744748 16.6915026,12.4744748 Z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        const chatMessagesContainer = document.getElementById('chatMessages');
        const searchInput = document.getElementById('searchInput');
        const sendButton = document.getElementById('sendButton');
        const WEBHOOK_URL = 'https://hook.eu1.make.com/shtszllbrl9nypp2i1td88g07ygjpaq4';
        
        let chatHistory = [];

        // Remove empty state when first message is sent
        function removeEmptyState() {
            const emptyState = chatMessagesContainer.querySelector('.empty-state');
            if (emptyState) {
                emptyState.remove();
            }
        }

        // Add message to chat
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';
            bubble.textContent = text;
            
            messageDiv.appendChild(bubble);
            chatMessagesContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            setTimeout(() => {
                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            }, 0);
        }

        // Show typing indicator
        function showTypingIndicator() {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.id = 'typingIndicator';
            
            const typing = document.createElement('div');
            typing.className = 'typing-indicator';
            typing.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            
            messageDiv.appendChild(typing);
            chatMessagesContainer.appendChild(messageDiv);
            
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typing = document.getElementById('typingIndicator');
            if (typing) {
                typing.remove();
            }
        }

        // Send message to webhook
        async function sendMessage() {
            const message = searchInput.value.trim();
            
            if (!message) return;

            removeEmptyState();
            addMessage(message, true);
            chatHistory.push({ role: 'user', content: message });
            
            searchInput.value = '';
            searchInput.focus();
            
            showTypingIndicator();

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        current_message: message,
                        chat_history: chatHistory
                    })
                });

                removeTypingIndicator();

                if (response.ok) {
                    const data = await response.json();
                    const botResponse = data.response || data.message || "I couldn't generate a response. Please try again.";
                    addMessage(botResponse, false);
                    chatHistory.push({ role: 'bot', content: botResponse });
                } else {
                    addMessage("Sorry, I encountered an error. Please try again.", false);
                }
            } catch (error) {
                removeTypingIndicator();
                console.error('Error:', error);
                addMessage("Connection error. Please check your internet and try again.", false);
            }
        }

        // Event listeners
        sendButton.addEventListener('click', sendMessage);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Focus input on load
        searchInput.focus();
    </script>
</body>
</html>
